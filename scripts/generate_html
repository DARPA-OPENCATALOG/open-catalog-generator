#!/usr/bin/python
import json
import re
from pprint import pprint
outfilename = "tmp/index.html"
outfile = open(outfilename, 'w')

json_file = open("data/data.json")
data = json.load(json_file)
json_file.close()

pubs_file = open("data/xdata_pubs.json")
pubs = json.load(pubs_file)
pubs_file.close()
#pprint (data) #debug
pubs_exist = {}
for record in pubs:
  for team in record['XData Teams']:
    pubs_exist[team] = 1

header = """
<html>
<link rel='stylesheet' href='style.css' type='text/css'/>
<script type='text/javascript' src='jquery-latest.js'></script> 
<script type='text/javascript' src='jquery.tablesorter.min.js'></script> 
<script type='text/javascript'>
$(document).ready(function() 
    { 
        $('#software').tablesorter({
		// sort on the first column and third column, order asc 
        	sortList: [[0,0],[1,0]] 
    	}); 
        $('#pubs').tablesorter({
		// sort on the first column and third column, order asc 
        	sortList: [[0,0],[1,0]] 
    	});
    } 
);
function jump(h){
    var url = location.href;
    location.href = "#"+h;
        history.replaceState(null,null,url)
}   
</script>
<table><tr><td><img height=50 src="darpalogo.png"></td><td valign=center><h2>Open Initiative Catalog</h2></td></tr></table>
<p>Welcome to the DARPA Open Initiative Catalog, which contains a curated list of DARPA-sponsored software and peer-reviewed publications. DARPA funds fundamental and applied research in a variety of areas including data science, cyber, anomaly detection, etc., which may lead to experimental results and reusable technology designed to benefit multiple government domains.</p>
<p>The DARPA Open Initiative Catalog organizes publically releasable material from DARPA programs, beginning with the <a href='http://www.darpa.mil/Our_Work/I2O/Programs/XDATA.aspx'>XDATA</a> program in the Information Innovation Office (I2O).  XDATA is developing an open source software library for big data. DARPA has an open source strategy through XDATA and other I2O programs to help increase the impact of government investments.</p>
<p>DARPA is interested in building communities around government-funded software and research. If the R&D community shows sufficient interest, DARPA will continue to make available information generated by DARPA programs, including software, publications, data and experimental results. Future updates are scheduled to include components from other I2O programs such as <a href='http://www.darpa.mil/Our_Work/I2O/Programs/Broad_Operational_Language_Translation_%28BOLT%29.aspx'>Broad Operational Language Translation (BOLT)</a> and <a href='http://www.darpa.mil/Our_Work/I2O/Programs/Visual_Media_Reasoning_%28VMR%29.aspx'>Visual Media Reasoning (VMR)</a>.</p>
<p>The DARPA Open Initiative Catalog contains two tables:</p>

<ul>
<li>The Software Table lists performers with one row per piece of software. Each piece of software has a link to an external project page, as well as a link to the code repository for the project. The software categories are listed; in the case of XDATA, they are Analytics, Visualization and Infrastructure. A description of the project is followed by the applicable software license. Finally, each entry has a link to the publications from each team's software entry.</li>
<li>The Publications Table contains author(s), title, and links to peer-reviewed articles related to specific DARPA programs.</li>
</ul>

<h4>Program Manager:</h4>
<p>Dr. Christopher White<br>
christopher.white@darpa.mil</p>

<p>Report a problem: <a href='mailto:opencatalog@darpa.mil'>opencatalog@darpa.mil</a></p>

<h5>The content below has been generated by organizations that are partially funded by DARPA; the views and conclusions contained therein are those of the authors and should not be interpreted as necessarily representing the official policies or endorsements, either expressed or implied, of DARPA or the U.S. Government.</h5>

<h2>Software:</h2>
<table id='software' class='tablesorter'> 
<thead> 
<tr> 
    <th>XDATA Team</th> 
    <th>Software</th> 
    <th>Category</th>
    <th>Instructional Material</th>
    <th>Code</th> 
    <th>Dev Stats</th>
    <th>Description</th> 
    <th>License</th> 
</tr> 
</thead> 
<tbody> 
"""
outfile.write(header)

print "Writing file...\n"
for record in data:
  elink = record['External Link']
  outfile.write("<TR>\n")
  outfile.write("<TD>" + record['XData Team'])
  if record['XData Team'] in pubs_exist:
    outfile.write("<br> <a href='#" + record['XData Team'] + "'>Publications</a>")
  outfile.write("</TD>\n")

  if re.search('^http',elink):
    outfile.write("<TD><a href='http://www.darpa.mil/External_Link.aspx?url=" + elink + "'>" + record['Software'] + "</a></TD>\n")
  else:
    outfile.write("<TD>" + record['Software'] + "</TD>\n")
  outfile.write("<TD>" + record['Category'] + "</TD>\n")
  stats = record['Stats']
  outfile.write("<TD>2014-07</TD>\n")
  clink = record['Public Code Repo']
  if re.search('^http',clink):
    outfile.write("<TD>" + clink + "</TD>\n")
    if stats != "":
      outfile.write("<TD><a href='stats/" + stats + "/index.html'>stats</a></TD>\n")
    else:
      outfile.write("<TD></TD>\n")
  else:
    outfile.write("<TD>" + clink + "</TD>\n")
    outfile.write("<TD></TD>\n")
  #outfile.write("<TD>Desc here</TD>\n")
  outfile.write("<TD>" + record['Characteristics of the Software (what software does)'].encode('utf8') + "</TD>\n")
  outfile.write("<TD>" + record['License'] + "</TD>\n")
  #pprint(record) #debug

table_sep = """
</tbody> 
</table>
<br><br>

<br><br>
<h2>Publications:</h2>
<table id='pubs' class='tablesorter'> 
<thead> 
<tr> 
    <th>XData Team</th> 
    <th>Title</th> 
    <th>Link</th>
</tr> 
</thead> 
<tbody> 
"""
outfile.write(table_sep)

for record in pubs:
  outfile.write("<TR>\n")
  outfile.write("<TD>")
  for team in record['XData Teams']:
    outfile.write(team + "<a name='" + team + "'>")
    if team != record['XData Teams'][len(record['XData Teams']) - 1]:
      outfile.write(", ")
  outfile.write("</TD>\n")
  outfile.write("<TD>" + record['Title'] + "</TD>\n")
  elink = record['Link']
  if re.search('^http',elink):
    outfile.write("<TD><a href='http://www.darpa.mil/External_Link.aspx?url=" + elink + "'>" + elink + "</a></TD>\n")
  else:
    outfile.write("<TD>" + elink + "</TD>\n")
  #pprint(record) #debug

footer = """
</tbody> 
</table>
<br>

<br><br><br>
<hr>
<a href='http://www.darpa.mil/FOIA.aspx'>FOIA</a><br>
<a href='http://www.darpa.mil/Privacy_Security_Notice.aspx'>Privacy and Security</a><br>
<a href='http://www.darpa.mil/NoFearAct.aspx'>No Fear Act</a><br>
<a href='http://www.darpa.mil/External_Link.aspx?url=http://dodcio.defense.gov/DoDSection508/Std_Stmt.aspx'>Accessibility/Section 508</a><br>
</html>
"""
outfile.write(footer)



































































